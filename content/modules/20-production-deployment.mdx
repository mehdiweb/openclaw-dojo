---
id: "20"
slug: "production-deployment"
title: "Production Deployment"
description: "Deploy at scale with monitoring and failover"
tier: "architect"
level: 4
estimatedTime: "90 min"
---

# Production Deployment

ðŸ—ï¸ **Architect Tier Module** - [Upgrade to access](/support)

Deploy your AI agent to production with enterprise-grade reliability, monitoring, and scalability. Learn Docker, Kubernetes, monitoring, and disaster recovery.

## What You'll Learn

- âœ… Containerize with Docker
- âœ… Deploy to Kubernetes
- âœ… Set up monitoring and alerting (Prometheus, Grafana)
- âœ… Implement high availability and failover
- âœ… Configure backup and disaster recovery
- âœ… Scaling strategies

## Prerequisites

Complete Modules 18 and 19 before starting this module.

---

## Step 1: Docker Containerization

### Create Dockerfile

```dockerfile
# Dockerfile
FROM node:18-alpine

# Install system dependencies
RUN apk add --no-cache \
    python3 \
    make \
    g++ \
    postgresql-client

# Create app directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci --only=production

# Copy application code
COPY . .

# Create non-root user
RUN addgroup -g 1001 openclaw && \
    adduser -D -u 1001 -G openclaw openclaw && \
    chown -R openclaw:openclaw /app

USER openclaw

# Expose ports
EXPOSE 3000 3001

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=40s \
  CMD node healthcheck.js || exit 1

# Start application
CMD ["node", "index.js"]
```

### Docker Compose for Local Development

```yaml
# docker-compose.yml
version: '3.8'

services:
  openclaw:
    build: .
    ports:
      - "3000:3000"
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgresql://openclaw:password@postgres:5432/openclaw
      - REDIS_URL=redis://redis:6379
    depends_on:
      - postgres
      - redis
    restart: unless-stopped
    volumes:
      - ./data:/app/data
    networks:
      - openclaw-network

  postgres:
    image: postgres:15-alpine
    environment:
      - POSTGRES_USER=openclaw
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=openclaw
    volumes:
      - postgres-data:/var/lib/postgresql/data
    networks:
      - openclaw-network

  redis:
    image: redis:7-alpine
    volumes:
      - redis-data:/data
    networks:
      - openclaw-network

  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus-data:/prometheus
    networks:
      - openclaw-network

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3002:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana-data:/var/lib/grafana
    networks:
      - openclaw-network

volumes:
  postgres-data:
  redis-data:
  prometheus-data:
  grafana-data:

networks:
  openclaw-network:
    driver: bridge
```

### Build and Run

```bash
# Build image
docker build -t openclaw:latest .

# Run with docker-compose
docker-compose up -d

# Check logs
docker-compose logs -f openclaw

# Stop
docker-compose down
```

---

## Step 2: Kubernetes Deployment

### Deployment Manifest

```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: openclaw
  labels:
    app: openclaw
spec:
  replicas: 3
  selector:
    matchLabels:
      app: openclaw
  template:
    metadata:
      labels:
        app: openclaw
    spec:
      containers:
      - name: openclaw
        image: your-registry/openclaw:latest
        ports:
        - containerPort: 3000
          name: http
        - containerPort: 3001
          name: webhooks
        env:
        - name: NODE_ENV
          value: "production"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: openclaw-secrets
              key: database-url
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: openclaw-secrets
              key: redis-url
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 3000
          initialDelaySeconds: 5
          periodSeconds: 5
```

### Service Manifest

```yaml
# k8s/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: openclaw
spec:
  type: LoadBalancer
  selector:
    app: openclaw
  ports:
  - name: http
    port: 80
    targetPort: 3000
  - name: webhooks
    port: 3001
    targetPort: 3001
```

### Secrets

```yaml
# k8s/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: openclaw-secrets
type: Opaque
stringData:
  database-url: "postgresql://user:pass@postgres:5432/openclaw"
  redis-url: "redis://redis:6379"
  anthropic-api-key: "sk-ant-xxxxx"
  openai-api-key: "sk-xxxxx"
```

### Deploy to Kubernetes

```bash
# Apply manifests
kubectl apply -f k8s/secrets.yaml
kubectl apply -f k8s/deployment.yaml
kubectl apply -f k8s/service.yaml

# Check status
kubectl get pods
kubectl get services

# View logs
kubectl logs -f deployment/openclaw

# Scale
kubectl scale deployment openclaw --replicas=5
```

---

## Step 3: Monitoring with Prometheus & Grafana

### Prometheus Configuration

```yaml
# prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'openclaw'
    static_configs:
      - targets: ['openclaw:3000']
    metrics_path: '/metrics'

  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres-exporter:9187']

  - job_name: 'redis'
    static_configs:
      - targets: ['redis-exporter:9121']
```

### Expose Metrics in OpenClaw

```javascript
// src/metrics.js
const prometheus = require('prom-client');

// Create metrics
const httpRequestDuration = new prometheus.Histogram({
  name: 'http_request_duration_seconds',
  help: 'HTTP request duration in seconds',
  labelNames: ['method', 'route', 'status']
});

const messageCounter = new prometheus.Counter({
  name: 'openclaw_messages_total',
  help: 'Total number of messages processed',
  labelNames: ['channel', 'status']
});

const activeUsers = new prometheus.Gauge({
  name: 'openclaw_active_users',
  help: 'Number of active users'
});

// Expose metrics endpoint
app.get('/metrics', async (req, res) => {
  res.set('Content-Type', prometheus.register.contentType);
  res.end(await prometheus.register.metrics());
});

module.exports = {
  httpRequestDuration,
  messageCounter,
  activeUsers
};
```

### Grafana Dashboard

```json
{
  "dashboard": {
    "title": "OpenClaw Production",
    "panels": [
      {
        "title": "Request Rate",
        "targets": [
          {
            "expr": "rate(http_request_duration_seconds_count[5m])"
          }
        ]
      },
      {
        "title": "Response Time (p95)",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, http_request_duration_seconds_bucket)"
          }
        ]
      },
      {
        "title": "Messages Processed",
        "targets": [
          {
            "expr": "rate(openclaw_messages_total[5m])"
          }
        ]
      },
      {
        "title": "Active Users",
        "targets": [
          {
            "expr": "openclaw_active_users"
          }
        ]
      }
    ]
  }
}
```

---

## Step 4: High Availability & Failover

### Load Balancer Configuration

```nginx
# nginx.conf
upstream openclaw {
    least_conn;
    server openclaw-1:3000 max_fails=3 fail_timeout=30s;
    server openclaw-2:3000 max_fails=3 fail_timeout=30s;
    server openclaw-3:3000 max_fails=3 fail_timeout=30s;
}

server {
    listen 80;
    server_name api.yourdomain.com;

    location / {
        proxy_pass http://openclaw;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_next_upstream error timeout http_502 http_503 http_504;
    }
}
```

### Database Replication

```yaml
# PostgreSQL primary-replica setup
# docker-compose.yml
services:
  postgres-primary:
    image: postgres:15-alpine
    environment:
      - POSTGRES_REPLICATION_MODE=master
      - POSTGRES_REPLICATION_USER=replicator
      - POSTGRES_REPLICATION_PASSWORD=repl_password

  postgres-replica:
    image: postgres:15-alpine
    environment:
      - POSTGRES_REPLICATION_MODE=slave
      - POSTGRES_MASTER_HOST=postgres-primary
      - POSTGRES_REPLICATION_USER=replicator
      - POSTGRES_REPLICATION_PASSWORD=repl_password
```

### Redis Sentinel for Failover

```yaml
services:
  redis-master:
    image: redis:7-alpine
    command: redis-server --appendonly yes

  redis-replica:
    image: redis:7-alpine
    command: redis-server --slaveof redis-master 6379

  redis-sentinel:
    image: redis:7-alpine
    command: redis-sentinel /etc/redis/sentinel.conf
    volumes:
      - ./sentinel.conf:/etc/redis/sentinel.conf
```

---

## Step 5: Backup & Disaster Recovery

### Automated Backups

```bash
#!/bin/bash
# backup.sh

# Database backup
pg_dump -h localhost -U openclaw openclaw | gzip > backup-$(date +%Y%m%d).sql.gz

# Upload to S3
aws s3 cp backup-$(date +%Y%m%d).sql.gz s3://backups/openclaw/

# Cleanup old backups (keep 30 days)
find /backups -name "backup-*.sql.gz" -mtime +30 -delete
```

### Cron Schedule

```bash
# crontab -e
0 2 * * * /opt/openclaw/backup.sh
```

### Disaster Recovery Plan

```yaml
# disaster-recovery.yaml
recovery_procedures:
  database_failure:
    - Promote replica to primary
    - Update application config
    - Restart services
    - Verify data integrity
    
  complete_failure:
    - Provision new infrastructure
    - Restore from latest backup
    - Apply transaction logs
    - Verify all services
    - Update DNS
    
  data_corruption:
    - Identify corruption point
    - Restore from backup before corruption
    - Replay transactions
    - Validate data
```

---

## Verification

Production readiness checklist:

```bash
# Health checks
curl http://localhost:3000/health
curl http://localhost:3000/ready

# Metrics
curl http://localhost:3000/metrics

# Load test
ab -n 10000 -c 100 http://localhost:3000/

# Failover test
docker stop openclaw-1
# Verify traffic routes to openclaw-2

# Backup test
./backup.sh
./restore.sh backup-20240204.sql.gz
```

---

## Scaling Strategies

### Horizontal Scaling

```bash
# Kubernetes
kubectl scale deployment openclaw --replicas=10

# Docker Swarm
docker service scale openclaw=10
```

### Vertical Scaling

```yaml
resources:
  requests:
    memory: "1Gi"
    cpu: "1000m"
  limits:
    memory: "2Gi"
    cpu: "2000m"
```

### Auto-scaling

```yaml
# k8s/hpa.yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: openclaw-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: openclaw
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

---

## ðŸŽ‰ Congratulations!

You've completed all 20 modules of OpenClaw Dojo! You're now ready to deploy production-grade AI agents at scale.

### What You've Mastered

**Foundation (Modules 1-7):**
- Installation and setup
- WhatsApp and Telegram integration
- Testing and troubleshooting

**Intermediate (Modules 8-13):**
- Memory systems
- Network integration
- Multimodal AI (audio & vision)
- Multi-channel support
- Security basics
- Performance tuning

**Advanced (Modules 14-17):**
- Advanced security hardening
- Custom tool development
- Browser automation
- Complex workflows

**Enterprise (Modules 18-20):**
- Multi-agent systems
- Plugin development
- Production deployment

---

## What's Next?

### Deploy Your Agent
- Choose your infrastructure (AWS, GCP, Azure)
- Set up monitoring and alerts
- Configure backups
- Go live!

### Join the Community
- Share your projects on [Discord](https://discord.com)
- Contribute to OpenClaw
- Help others learn

### Keep Learning
- Follow OpenClaw blog for updates
- Attend community calls
- Explore advanced patterns

---

## Need Help?

- **1-on-1 Setup Call:** Included with Architect tier
- **Discord Community:** [Join here](https://discord.com)
- **Email Support:** support@openclaw.army
- **Documentation:** [docs.openclaw.army](https://docs.openclaw.army)

---

Thank you for learning with OpenClaw Dojo! ðŸ¦ž

**Built something cool?** Share it with [@OpenClawArmy](https://twitter.com/openclawArmy) on Twitter!
